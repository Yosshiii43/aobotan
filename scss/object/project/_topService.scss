/******************************
Top service
******************************/
@use "../../foundation/forwards" as *;
@use "sass:math";

.p-topService {
  /* ========== SP初期値 ========== */
  --main-offset    : 0px;    /* main 左余白 (SP=0) */
  --bg-left-gap    : 100px;  /* 背景 左余白 */
  --bg-top-gap     : 52px;   /* 背景 上余白 */
  --bg-bottom-gap  : 55px;   /* 背景 下余白 */
  --inner-pad-l    : 20px;   /* インナー 左余白 */
  --inner-pad-r    : 20px;   /* インナー 右余白 */
  --content-gap    : #{rem(22)};  /* SP用 コンテンツ間gap */
  --content-gap-pc : #{rem(56)};  /* PC用 コンテンツ間gap */

  position: relative;
  isolation: isolate;
  padding-block: var(--bg-top-gap) var(--bg-bottom-gap);

  /* ===== 背景帯：はみ出さない formula =====
     left:  main-offset + bg-left-gap
     width: 100vw - (main-offset + bg-left-gap)
     => left + width = 100vw なので絶対に横スクロールしない */
  &::before {
    content: "";
    position: absolute;
    top: var(--bg-top-gap);
    bottom: var(--bg-bottom-gap);

    /* 親(.p-topService) 基準で “背景の左余白” だけズラす */
    left : var(--bg-left-gap);
    /* 右端はビューポート右端に合わせたいので main-offset をここでだけ引く */
    width: calc(100vw - var(--main-offset) - var(--bg-left-gap));

    background: $color-lightgray;
    border-radius: 50px 0 0 50px;
    z-index: -1;
  }

  @include mq("pc") {
    --main-offset  : #{rem(280)};
    --bg-left-gap  : 192px;
    --bg-top-gap   : 85px;
    --bg-bottom-gap: 55px;
    --num-hide: clamp(
      10px,
      calc(10px + (21 - 10) * ((100vw - 1024px) / (1440 - 1024))),
      21px
    );
    --right-gap : clamp(
      30px, 
      calc(30px + (158 - 30) * ((100vw - 1024px) / (1440 - 1024))), 
      158px
    );
    --img-track : clamp(
      280px, 
      calc(280px + (516 - 280) * ((100vw - 1024px) / (1440 - 1024))), 
      516px
    );

    &::before {
      left : var(--bg-left-gap);
      width: calc(100vw - var(--main-offset) - var(--bg-left-gap));
    }
  }

  /* ===== インナー ===== */
  &__inner {
    //padding-left : var(--inner-pad-l);
    //padding-right: var(--inner-pad-r);
    padding-left : 0;
    padding-right: var(--right-gap);
    box-sizing   : border-box;
    position     : relative;
    z-index      : 1;

    @include mq("pc") {
      /* PCで padding を上書き */
      padding-left : 0;
      padding-right: 158px; /* 指定値 */
      padding-right: rclamp(30, 158, 375, 1440);
    }
  }

  /* ===== タイトル ===== */
  &__title {
    margin-bottom: rem(24);

    @include mq("pc") {
      margin-bottom: rem(64);
    }
  }

  /* ===== コンテンツ行 ===== */
  &__content {
    /* SP: 縦積み（画像下・本文上） */
    display: flex;
    flex-direction: column-reverse;
    gap: var(--content-gap);
    margin-bottom: rem(50);
    > * { min-width: 0; } /* テキストのオーバーフロー対策 */

    &:last-of-type { margin-bottom: 0; }

    @include mq("pc") {
      display:grid;
      grid-template-areas: "img body";
      grid-template-columns: var(--img-track) minmax(0, 1fr);
      column-gap: var(--content-gap-pc);
      margin-bottom: rem(92);
      width: min(calc(100vw - var(--main-offset) - var(--right-gap)), 1002px);
    }

    /* 2番目逆配置用（HTML側で付与） */
    &.is-reverse {
      @include mq("pc") {
        grid-template-areas: "body img";
        grid-template-columns: minmax(0, 1fr) var(--img-track);
      }
    }
  }

  /* ===== 本文ブロック ===== */
  &__contentBody {
    grid-area: body;
    position: relative;
    @include mq("pc") {
      padding-top: rclamp(98, 168, 1024, 1440);
    }

    /* 見出し（数字+タイトル） */
    .p-topService__contentTitle {
      display: flex;
      flex-direction: row-reverse;
      align-items: center;
      justify-content: space-between;
      margin-bottom: rem(15);

      span:first-child {
        color: $color-bluegray;
        font-family: Kanit;
        font-size: rem(48);
        font-weight: 700;
        line-height: 1;
      }
      span:last-child {
        font-size: rem(24);
        font-weight: 700;
        line-height: 1;
        padding: rem(10) rem(16);
        background-color: $color-white;
      }

      @include mq("pc") {
        flex-direction: row;
        margin-bottom: rem(48);

        span:first-child { display: none; }
        /* span:last-child は同じ */
      }
    }

    /* 本文テキスト */
    .p-topService__contentText {
      margin-bottom: rem(28);
      max-width: 100%; /* 固定幅禁止 */

      @include mq("pc") {
        /* どうしても上限を持たせたいなら clamp */
        max-width: clamp(280px, 45vw, 430px);
      }
    }

    .c-button--a {
      /* 既存 component をそのまま */
    }
  }

  /* ===== 画像 ===== */
  .p-topService__imgWrap {
    position: relative;
    grid-area: img; /* 画像列に入る */
    z-index: 2;     /* 画像自体はここで */
  }

  .p-topService__contentImg {
    grid-area: img;
    width: 100%;
    height: auto;
    object-fit: cover;

    @include mq("pc") {
      width: 100%;
      height: auto;
      object-fit: cover;
      aspect-ratio: 335 / 301;
      position: relative;
      z-index: 2;
      /* 幅は grid 列で制御するのでここで指定不要 */
    }
  }

  /* でかい番号 */
  .p-topService__nam {
    display: none;

    @include mq("pc") {
      display: flex;
      width: fit-content;
      position: absolute;
      z-index: 1;                    /* 画像より下 */
      top: 0;
      left: 100%;
      transform: translateX(calc( -1 * var(--num-hide)));
      font-family: Kanit;
      font-size: rclamp(98, 168, 1024, 1440);
      font-weight: 700;
      line-height: 1;
      color: $color-bluegray;
      font-family: Kanit;
      white-space: nowrap;
    }
  }
  .p-topService__nam--r {
    @include mq("pc") {
      inset-inline-start: auto;
      inset-inline-end: 0;
      right: 100%;
      transform: translateX(var(--num-hide));
    }
  }

  /* ===== イラスト ===== */
  &__catch {
    position: absolute;
    top: rem(4);
    right: rem(20);
    width: rclamp(69, 124, 375, 1440);
    height: auto;
    z-index: 2;

    @include mq("pc") {
      top: rem(178);
      right: rem(178);
      width: rem(124);
    }
  }
}